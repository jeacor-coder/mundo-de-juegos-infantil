<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mi Mundo de Juegos ğŸš€</title>
  <style>
    :root{
      --bg:#f0f9ff;            /* azul cielo */
      --card:#ffffff;
      --ink:#0f172a;           /* azul marino */
      --muted:#475569;         /* gris azulado */
      --b:#dbeafe;             /* azul claro */
      --shadow: 0 10px 30px rgba(2,6,23,.12);
      --radius: 22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink);
      background:
        radial-gradient(circle at 10% 10%, #dbeafe, transparent 45%),
        radial-gradient(circle at 90% 20%, #dcfce7, transparent 40%),
        radial-gradient(circle at 50% 90%, #fef9c3, transparent 45%),
        var(--bg);
      min-height:100vh;
    }
    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: rgba(240,249,255,.78);
      border-bottom: 1px solid rgba(219,234,254,.9);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:14px 16px;}
    .topbar{display:flex; align-items:center; gap:12px; justify-content:space-between; flex-wrap:wrap;}
    .brand{display:flex; align-items:center; gap:10px;}
    .logo{
      width:44px; height:44px; border-radius:14px;
      background: conic-gradient(from 200deg, #38bdf8, #22c55e, #facc15, #38bdf8);
      box-shadow: var(--shadow);
      position:relative;
    }
    .logo:after{
      content:"ğŸš€";
      position:absolute; inset:0;
      display:grid; place-items:center;
      font-size:22px; color:#ffffff; text-shadow:0 3px 10px rgba(0,0,0,.25);
    }
    h1{margin:0; font-size:18px; line-height:1.1}
    .subtitle{margin:0; color:var(--muted); font-size:12px}
    nav{display:flex; gap:8px; flex-wrap:wrap;}
    .pill{
      border:1px solid rgba(219,234,254,.95);
      background: rgba(255,255,255,.78);
      padding:8px 10px;
      border-radius:999px;
      font-weight:800;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .pill:active{transform: translateY(1px) scale(.99)}
    .pill:hover{box-shadow: 0 6px 18px rgba(2,6,23,.10)}

    main{max-width:1100px; margin:0 auto; padding:18px 16px 70px;}
    .grid{display:grid; grid-template-columns: 1.2fr .8fr; gap:14px;}
    @media (max-width: 920px){.grid{grid-template-columns:1fr;}}

    .card{
      background: rgba(255,255,255,.88);
      border:1px solid rgba(219,234,254,.95);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:16px;
    }
    .card h2{margin:0 0 10px; font-size:16px}
    .card p{margin:6px 0; color:var(--muted)}

    .hero{display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;}
    .heroLeft{display:flex; gap:12px; align-items:center;}
    .bigEmoji{font-size:44px; filter: drop-shadow(0 10px 18px rgba(0,0,0,.08));}

    .actions{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    button{
      border:1px solid rgba(219,234,254,.95);
      background:#fff;
      padding:10px 12px;
      border-radius: 14px;
      font-weight:900;
      cursor:pointer;
      box-shadow: 0 6px 16px rgba(2,6,23,.08);
      transition: transform .08s ease;
    }
    button:active{transform: translateY(1px) scale(.99)}
    .btnPrimary{background: linear-gradient(135deg, #38bdf8, #22c55e); color:#fff; border-color:transparent;}
    .btnGhost{background: rgba(255,255,255,.7);}

    /* Gallery */
    .galleryTop{display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;}
    .gallery{margin-top:12px; display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;}
    @media (max-width: 560px){.gallery{grid-template-columns: repeat(2, 1fr);}}
    .tile{
      border:1px solid rgba(219,234,254,.95);
      background: rgba(255,255,255,.92);
      border-radius: 18px;
      overflow:hidden;
      min-height:110px;
      display:grid; place-items:center;
      position:relative;
    }
    .tile img{width:100%; height:100%; object-fit:cover; display:block;}
    .tile .placeholder{font-size:44px;}
    .tile .label{
      position:absolute; left:10px; bottom:10px;
      background: rgba(255,255,255,.86);
      border:1px solid rgba(219,234,254,.95);
      padding:6px 8px;
      border-radius: 999px;
      font-weight:900;
      font-size:12px;
    }

    /* Tags */
    .tag{font-size:12px; font-weight:900; padding:6px 10px; border-radius:999px; border:1px solid rgba(219,234,254,.95); background:#fff;}

    /* Tracing */
    .traceTop{display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;}
    canvas{
      width:100%;
      height:260px;
      background: rgba(255,255,255,.92);
      border:1px solid rgba(219,234,254,.95);
      border-radius: 18px;
      touch-action:none;
    }

    /* Games menu */
    .gamesMenu{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }
    @media (max-width: 700px){.gamesMenu{grid-template-columns: repeat(2, 1fr);}}
    .gameIcon{
      border:1px solid rgba(219,234,254,.95);
      background: rgba(255,255,255,.92);
      border-radius: 18px;
      padding:12px;
      min-height:92px;
      display:flex;
      gap:10px;
      align-items:center;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 6px 16px rgba(2,6,23,.06);
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .gameIcon:active{transform: translateY(1px) scale(.99)}
    .gameIcon:hover{box-shadow: 0 10px 22px rgba(2,6,23,.10)}
    .gameIcon .ico{font-size:32px;}
    .gameIcon .meta{display:grid; gap:2px;}
    .gameIcon .name{font-weight:1000;}
    .gameIcon .desc{color:var(--muted); font-size:12px; font-weight:800;}

    .panelTop{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;}

    /* Matching/memorama */
    .matchGrid{display:grid; grid-template-columns: repeat(4, 1fr); gap:10px; margin-top:10px;}
    @media (max-width: 560px){.matchGrid{grid-template-columns: repeat(3, 1fr);}}
    .matchCard{
      border:1px solid rgba(219,234,254,.95);
      background: rgba(255,255,255,.94);
      border-radius: 18px;
      min-height:74px;
      display:grid; place-items:center;
      font-size:28px;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .matchCard:active{transform: translateY(1px) scale(.99)}
    .matchCard.matched{opacity:.55}

    /* Number-quantity */
    .numBig{font-size:64px; font-weight:1000; line-height:1;}
    .dots{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;}
    .dot{width:44px; height:44px; border-radius:16px; display:grid; place-items:center; border:1px solid rgba(219,234,254,.95); background: rgba(255,255,255,.92); font-size:24px;}

    /* Missing */
    .rowCards{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}
    .bigCard{
      width:84px; height:84px; border-radius:22px;
      display:grid; place-items:center;
      border:1px solid rgba(219,234,254,.95);
      background: rgba(255,255,255,.92);
      font-size:36px;
      user-select:none;
    }

    /* Sequence */
    .seqSlots{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}
    .slot{width:84px; height:84px; border-radius:22px; display:grid; place-items:center; border:2px dashed rgba(71,85,105,.35); background: rgba(255,255,255,.75); font-size:36px;}
    .choices{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}
    .choice{width:84px; height:84px; border-radius:22px; display:grid; place-items:center; border:1px solid rgba(219,234,254,.95); background: rgba(255,255,255,.92); font-size:36px; cursor:pointer; user-select:none;}

    /* Social */
    .socialGrid{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:10px;}
    @media (max-width: 560px){.socialGrid{grid-template-columns: repeat(2, 1fr);}}
    .socialBtn{
      border:1px solid rgba(219,234,254,.95);
      background: rgba(255,255,255,.92);
      border-radius: 18px;
      padding:12px;
      display:flex;
      gap:10px;
      align-items:center;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 6px 16px rgba(2,6,23,.06);
    }
    .socialBtn .ico{font-size:26px;}
    .socialBtn .txt{display:grid; gap:2px;}
    .socialBtn .txt b{font-size:13px;}
    .socialBtn .txt span{font-size:12px; color:var(--muted); font-weight:800;}

    .footerNote{color:var(--muted); font-size:12px; margin-top:10px}

    .toast{
      position: fixed; left:50%; bottom:16px; transform: translateX(-50%);
      background: rgba(2,6,23,.92); color:#fff;
      padding:10px 12px; border-radius: 999px;
      font-weight:900; font-size:12px;
      box-shadow: 0 12px 30px rgba(0,0,0,.18);
      display:none;
      z-index:50;
      max-width: calc(100vw - 28px);
      text-align:center;
    }

    /* Hide/show panels */
    [hidden]{display:none !important;}
  </style>
</head>
<body>
  <header>
    <div class="wrap topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>El Mundo de Juegos de Fernando ğŸš€</h1>
          <p class="subtitle">Para aprender y divertirse (5 aÃ±os)</p>
        </div>
      </div>
      <nav>
        <div class="pill" data-scroll="#juegos">ğŸ® Juegos</div>
        <div class="pill" data-scroll="#lectura">ğŸ“˜ Lectura</div>
        <div class="pill" data-scroll="#trazo">âœï¸ Trazos</div>
        <div class="pill" data-scroll="#colorear">ğŸ¨ Colorear</div>
        <div class="pill" data-scroll="#escribir">ğŸ“ Escribir</div>
        <div class="pill" data-scroll="#efectos">ğŸ¶ Efectos</div>
        <div class="pill" data-scroll="#galeria">ğŸ§¸ Peluches</div>
        <div class="pill" data-scroll="#redes">ğŸŒˆ Redes</div>
      </nav>
    </div>
  </header>

  <main>
    <section class="card" id="inicio">
      <div class="hero">
        <div class="heroLeft">
          <div class="bigEmoji" aria-hidden="true">ğŸ¦–</div>
          <div>
            <h2>Â¡Hola bienvenido a la pÃ¡gina web de Fernando! ğŸ‘‹</h2>
            <p>Elige una secciÃ³n arriba. AquÃ­ hay miniâ€‘juegos, lectura, escritura y sorpresas.</p>
            <p class="footerNote">Tip: sesiones cortas (10â€“15 min) funcionan mejor. â­</p>
          </div>
        </div>
        <div class="actions">
          <button class="btnPrimary" id="btnConfetti">ğŸ‰ Fiesta</button>
          <button id="btnSound">ğŸ”Š Beep</button>
        </div>
      </div>
    </section>

    <div class="grid" style="margin-top:14px;">

      <!-- Left column -->
      <div class="stack" style="display:grid; gap:14px;">

        <!-- GAMES (menu + panels) -->
        <section class="card" id="juegos">
          <div class="panelTop">
            <div>
              <h2>Juegos ğŸ®</h2>
              <p>Elige un Ã­cono para jugar. (Puedes volver al menÃº cuando quieras.)</p>
            </div>
            <div class="actions">
              <button class="btnGhost" id="btnBackToMenu" hidden>â¬…ï¸ Volver</button>
            </div>
          </div>

          <!-- Games Menu -->
          <div id="gamesMenu" class="gamesMenu" aria-label="MenÃº de juegos">
            <div class="gameIcon" data-open="memorama">
              <div class="ico">ğŸ§ </div>
              <div class="meta">
                <div class="name">Memorama</div>
                <div class="desc">Encuentra parejas</div>
              </div>
            </div>
            <div class="gameIcon" data-open="parejas">
              <div class="ico">ğŸ”—</div>
              <div class="meta">
                <div class="name">Parejas</div>
                <div class="desc">Cosas que van juntas</div>
              </div>
            </div>
            <div class="gameIcon" data-open="numeros">
              <div class="ico">ğŸ”¢</div>
              <div class="meta">
                <div class="name">NÃºmeros</div>
                <div class="desc">NÃºmero + cantidad</div>
              </div>
            </div>
            <div class="gameIcon" data-open="falta">
              <div class="ico">â“</div>
              <div class="meta">
                <div class="name">Â¿CuÃ¡l falta?</div>
                <div class="desc">Completa el patrÃ³n</div>
              </div>
            </div>
            <div class="gameIcon" data-open="secuencia">
              <div class="ico">ğŸ§©</div>
              <div class="meta">
                <div class="name">Secuencias</div>
                <div class="desc">Ordena la historia</div>
              </div>
            </div>
          </div>

          <!-- Game Panels -->
          <div id="gamePanels" hidden>

            <!-- Memorama -->
            <div id="game-memorama" hidden>
              <div class="panelTop" style="margin-top:10px;">
                <div class="actions">
                  <button id="btnNewMatch" class="btnPrimary">ğŸ”„ Nuevo</button>
                  <span class="tag">Intentos: <span id="tries">0</span></span>
                  <span class="tag">Parejas: <span id="pairs">0</span>/6</span>
                </div>
              </div>
              <div class="matchGrid" id="matchGrid" aria-label="Cartas de memorama"></div>
              <p class="footerNote">Tip: si estÃ¡ difÃ­cil, juega con 4 parejas (lo puedo ajustar si quieres).</p>
            </div>

            <!-- Related pairs -->
            <div id="game-parejas" hidden>
              <div class="panelTop" style="margin-top:10px;">
                <div class="actions">
                  <button id="btnNewPairs" class="btnPrimary">ğŸ”„ Nuevo</button>
                  <span class="tag">Aciertos: <span id="pairHits">0</span>/6</span>
                </div>
              </div>
              <p class="footerNote">Toca 2 cartas. Si van juntas, Â¡ganas un punto! â­</p>
              <div class="matchGrid" id="pairsGrid" aria-label="Cartas de parejas relacionadas"></div>
            </div>

            <!-- Numbers -->
            <div id="game-numeros" hidden>
              <div class="panelTop" style="margin-top:10px;">
                <div>
                  <div class="tag">Cuenta los objetos y elige el nÃºmero.</div>
                </div>
                <div class="actions">
                  <button id="btnNewNumber" class="btnPrimary">ğŸ² Nuevo</button>
                  <button id="btnSayNumber">ğŸ—£ï¸ Leer</button>
                </div>
              </div>
              <div style="display:flex; gap:14px; align-items:flex-start; flex-wrap:wrap; margin-top:10px;">
                <div class="card" style="padding:12px; flex: 1 1 220px;">
                  <div class="numBig" id="numTarget">5</div>
                  <div class="dots" id="numDots"></div>
                </div>
                <div class="card" style="padding:12px; flex: 1 1 220px;">
                  <div class="tag">Elige:</div>
                  <div class="rowCards" id="numChoices"></div>
                </div>
              </div>
              <p class="footerNote">Puedes cambiar los emojis a carritos, dinos o pelotas si quieres.</p>
            </div>

            <!-- Missing -->
            <div id="game-falta" hidden>
              <div class="panelTop" style="margin-top:10px;">
                <div class="actions">
                  <button id="btnNewMissing" class="btnPrimary">ğŸ² Nuevo</button>
                  <span class="tag">Racha: <span id="streak">0</span></span>
                </div>
              </div>
              <p class="footerNote">Â¿CuÃ¡l falta? Mira la fila y completa con la opciÃ³n correcta.</p>
              <div class="rowCards" id="missingRow"></div>
              <div class="rowCards" id="missingOptions" style="margin-top:12px;"></div>
            </div>

            <!-- Sequence -->
            <div id="game-secuencia" hidden>
              <div class="panelTop" style="margin-top:10px;">
                <div class="actions">
                  <button id="btnNewSeq" class="btnPrimary">ğŸ² Nueva</button>
                  <button id="btnCheckSeq">âœ… Revisar</button>
                </div>
              </div>
              <p class="footerNote">Toca las piezas de abajo para llenar los espacios en orden.</p>
              <div class="seqSlots" id="seqSlots"></div>
              <div class="choices" id="seqChoices"></div>
            </div>

          </div>
        </section>

        <!-- Reading / Words -->
        <section class="card" id="lectura">
          <h2>Lectura: Palabras reales ğŸ“˜</h2>
          <p>Lee una palabra y escÃºchala. (Funciona si el navegador permite voz.)</p>
          <div class="card" style="padding:12px;">
            <div class="tag">SÃ­labas</div>
            <div style="font-size:42px; font-weight:1000; letter-spacing:1px;" id="syllable">MA-MA</div>
            <div class="tag" style="margin-top:8px;">Palabra</div>
            <div style="font-size:46px; font-weight:1000;" id="word">MAMA</div>
            <div class="actions" style="margin-top:12px;">
              <button class="btnPrimary" id="btnNewWord">ğŸ² Nueva</button>
              <button id="btnSpeakWord">ğŸ—£ï¸ Leer</button>
              <button id="btnClapWord">ğŸ‘ Â¡Bien!</button>
            </div>
          </div>
          <p class="footerNote">Tip: pÃ­dele que encuentre un objeto que empiece con esa palabra/letra.</p>
        </section>

        <!-- Tracing -->
        <section class="card" id="trazo">
          <div class="traceTop">
            <div>
              <h2>Escritura y Trazos âœï¸</h2>
              <p>Elige una letra (Aâ€“Z) y si la quieres MAYÃšSCULA o minÃºscula.</p>
            </div>
            <div class="actions">
              <select id="letterSelect" class="tag" style="padding:8px 10px;"></select>
              <select id="caseSelect" class="tag" style="padding:8px 10px;">
                <option value="upper" selected>MAYÃšSCULA</option>
                <option value="lower">minÃºscula</option>
              </select>
              <button id="btnTraceReset">ğŸ§½ Borrar</button>
            </div>
          </div>
          <canvas id="traceCanvas" aria-label="Zona de trazo"></canvas>
          <p class="footerNote">Consejo: dedo en tablet o mouse en PC. ğŸ“±ğŸ–±ï¸</p>
        </section>

        <section class="card" id="colorear">
          <div class="traceTop">
            <div>
              <h2>Colorear ğŸ¨</h2>
              <p>Elige un dibujo y pinta encima (preestablecidos).</p>
            </div>
            <div class="actions">
              <select id="colorTemplate" class="tag" style="padding:8px 10px;">
                <option value="free" selected>ğŸ†“ Libre</option>
                <option value="dino">ğŸ¦– Dino</option>
                <option value="car">ğŸš— Carro</option>
                <option value="rocket">ğŸš€ Cohete</option>
                <option value="star">â­ Estrella</option>
              </select>
              <button id="btnColorReset">ğŸ§½ Limpiar</button>
              <label class="tag" style="display:flex; gap:8px; align-items:center; cursor:pointer;">
                <input id="showGuide" type="checkbox" checked style="accent-color:#22c55e;" />
                GuÃ­a
              </label>
            </div>
          </div>
          <div class="actions" style="margin-top:10px;">
            <span class="tag">Color:</span>
            <button class="btnGhost" data-color="#ef4444">ğŸ”´</button>
            <button class="btnGhost" data-color="#3b82f6">ğŸ”µ</button>
            <button class="btnGhost" data-color="#22c55e">ğŸŸ¢</button>
            <button class="btnGhost" data-color="#facc15">ğŸŸ¡</button>
            <button class="btnGhost" data-color="#a855f7">ğŸŸ£</button>
            <button class="btnGhost" data-color="#111827">âš«</button>
            <button class="btnGhost" data-color="#ffffff">âšª</button>
            <span class="tag">Grosor:</span>
            <select id="brushSize" class="tag" style="padding:8px 10px;">
              <option value="6">6</option>
              <option value="10" selected>10</option>
              <option value="16">16</option>
              <option value="22">22</option>
            </select>
          </div>
          <canvas id="colorCanvas" aria-label="Zona de colorear" style="margin-top:10px;"></canvas>
          <p class="footerNote">Tip: pinta encima del dibujo. Usa â€œLimpiarâ€ para empezar de nuevo.</p>
        </section>

        <section class="card" id="escribir">
          <h2>Escribir y escuchar ğŸ“ğŸ”Š</h2>
          <p>Escribe una frase y presiona â€œLeerâ€.</p>
          <textarea id="textToRead" rows="4" placeholder="Escribe aquÃ­â€¦" style="width:100%; padding:12px; border-radius:18px; border:1px solid rgba(219,234,254,.95); font-size:18px; font-weight:800; outline:none;"></textarea>
          <div class="actions" style="margin-top:10px;">
            <button id="btnReadText" class="btnPrimary">ğŸ—£ï¸ Leer</button>
            <button id="btnClearText">ğŸ§¹ Borrar</button>
            <button id="btnSticker">âœ¨ Sorpresa</button>
          </div>
          <p class="footerNote">Ejemplos: â€œHola mamÃ¡â€, â€œMe gustan los dinosâ€, â€œHoy juguÃ©â€.</p>
        </section>

      </div>

      <!-- Right column -->
      <div class="stack" style="display:grid; gap:14px;">

        <!-- Effects -->
        <section class="card" id="efectos">
          <h2>Efectos y Sonidos ğŸ¶âœ¨</h2>
          <p>Toca los botones para escuchar sonidos y ver sorpresas.</p>
          <div class="actions" style="margin-top:10px;">
            <button id="btnClap">ğŸ‘ Aplausos</button>
            <button id="btnPop">ğŸˆ Pop</button>
            <button id="btnDrum">ğŸ¥ Tambor</button>
            <button id="btnMagic">âœ¨ Magia</button>
            <button id="btnRocket">ğŸš€ Cohete</button>
          </div>
          <p class="footerNote">Estos efectos ayudan a la atenciÃ³n y coordinaciÃ³n causaâ€“efecto.</p>
        </section>

        <!-- Gallery -->
        <section class="card" id="galeria">
          <div class="galleryTop">
            <div>
              <h2>GalerÃ­a de Peluches ğŸ§¸</h2>
              <p>Agrega fotos desde tu compu/cel. (Se quedan solo en tu navegador.)</p>
            </div>
            <div class="actions">
              <label class="tag" for="fileInput" style="cursor:pointer;">ğŸ“· Agregar</label>
              <input id="fileInput" type="file" accept="image/*" multiple style="display:none" />
              <button id="btnClearGallery" title="Borra fotos cargadas">ğŸ§¹ Limpiar</button>
            </div>
          </div>
          <div class="gallery" id="gallery">
            <div class="tile" data-default="1"><div class="placeholder">ğŸ§¸</div><div class="label">Oso</div></div>
            <div class="tile" data-default="1"><div class="placeholder">ğŸ°</div><div class="label">Conejo</div></div>
            <div class="tile" data-default="1"><div class="placeholder">ğŸ¦–</div><div class="label">Dino</div></div>
            <div class="tile" data-default="1"><div class="placeholder">ğŸ»</div><div class="label">Oso</div></div>
            <div class="tile" data-default="1"><div class="placeholder">ğŸ™</div><div class="label">Pulpo</div></div>
            <div class="tile" data-default="1"><div class="placeholder">ğŸ¦Š</div><div class="label">Zorro</div></div>
          </div>
        </section>

        <!-- Social -->
        <section class="card" id="redes">
          <h2>Redes (modo juego) ğŸŒˆ</h2>
          <p>Son botones de juego: no abren internet. Al tocar, hay una sorpresa.</p>
          <div class="socialGrid" id="socialGrid"></div>
          <p class="footerNote">Tip: puedes explicar â€œesto es solo para jugarâ€. âœ…</p>
        </section>

        <!-- Daily challenge -->
        <section class="card">
          <h2>Miniâ€‘Reto del DÃ­a â­</h2>
          <p id="dailyChallenge">Encuentra 3 cosas rojas en casa. â¤ï¸</p>
          <div class="actions" style="margin-top:10px;">
            <button id="btnNewChallenge">ğŸ² Otro reto</button>
            <button id="btnReadChallenge">ğŸ—£ï¸ Leer</button>
          </div>
        </section>

      </div>

    </div>

    <p class="footerNote" style="margin-top:14px;">
      Privacidad: esta pÃ¡gina no envÃ­a nada a internet. Evita fotos sensibles si compartes tu pantalla.
    </p>
  </main>

  <div class="toast" id="toast">Â¡Hola!</div>

  <script>
    // ---------------------- Helpers ----------------------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    const toastEl = $('#toast');
    let toastTimer = null;
    function toast(msg){
      toastEl.textContent = msg;
      toastEl.style.display = 'block';
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toastEl.style.display='none', 1400);
    }

    function speak(text){
      try{
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'es-MX';
        u.rate = 0.95;
        speechSynthesis.cancel();
        speechSynthesis.speak(u);
      }catch{ /* noop */ }
    }

    // ---------------------- Navigation ----------------------
    $$('.pill').forEach(p => {
      p.addEventListener('click', () => {
        const id = p.getAttribute('data-scroll');
        const el = document.querySelector(id);
        if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // ---------------------- Confetti ----------------------
    function confettiEmojis(){
      const count = 26;
      for(let i=0;i<count;i++){
        const s = document.createElement('span');
        s.textContent = ['ğŸ‰','âœ¨','â­','ğŸ«§','ğŸ’¥','âš¡'][Math.floor(Math.random()*6)];
        s.style.position='fixed';
        s.style.left = Math.random()*100 + 'vw';
        s.style.top = (-10 - Math.random()*20) + 'px';
        s.style.fontSize = (18 + Math.random()*18) + 'px';
        s.style.zIndex=80;
        s.style.filter='drop-shadow(0 8px 10px rgba(0,0,0,.12))';
        document.body.appendChild(s);
        const fall = 100 + Math.random()*50;
        const drift = (Math.random()*2-1) * 25;
        s.animate([
          { transform:`translate(0,0) rotate(0deg)`, opacity:1 },
          { transform:`translate(${drift}vw, ${fall}vh) rotate(${360+Math.random()*360}deg)`, opacity:0.08 }
        ], { duration: 1400 + Math.random()*800, easing:'cubic-bezier(.2,.8,.2,1)' });
        setTimeout(()=> s.remove(), 2400);
      }
    }

    $('#btnConfetti').addEventListener('click', () => {
      confettiEmojis();
      toast('Â¡Fiesta! ğŸ‰');
    });

    // ---------------------- Audio (simple tones) ----------------------
    let audioCtx = null;
    function playTone(freq = 440, time = 0.25, type = 'triangle'){
      try{
        audioCtx ??= new (window.AudioContext || window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type;
        o.frequency.value = freq;
        g.gain.value = 0.0001;
        o.connect(g).connect(audioCtx.destination);
        o.start();
        g.gain.exponentialRampToValueAtTime(0.2, audioCtx.currentTime + 0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + time);
        o.stop(audioCtx.currentTime + time + 0.02);
      }catch{ /* noop */ }
    }

    $('#btnSound').addEventListener('click', () => {
      playTone(520, 0.25);
      toast('Â¡Beep! ğŸ”Š');
    });

    // Effects buttons
    $('#btnClap').addEventListener('click', () => {
      playTone(320, 0.10); playTone(420, 0.12);
      toast('Â¡Bravo! ğŸ‘');
    });
    $('#btnPop').addEventListener('click', () => {
      playTone(880, 0.08, 'square');
      toast('Â¡Pop! ğŸˆ');
    });
    $('#btnDrum').addEventListener('click', () => {
      playTone(160, 0.18, 'sine');
      toast('Â¡Boom! ğŸ¥');
    });
    $('#btnMagic').addEventListener('click', () => {
      confettiEmojis();
      playTone(600, 0.14); playTone(900, 0.18);
      toast('Â¡Magia! âœ¨');
    });
    $('#btnRocket').addEventListener('click', () => {
      confettiEmojis();
      playTone(220, 0.08); setTimeout(()=> playTone(440, 0.08), 90); setTimeout(()=> playTone(720, 0.10), 170);
      toast('Â¡Despegue! ğŸš€');
    });

    // ---------------------- Gallery upload ----------------------
    const fileInput = $('#fileInput');
    const gallery = $('#gallery');

    fileInput.addEventListener('change', async (e) => {
      const files = Array.from(e.target.files || []);
      if(!files.length) return;
      $$('.tile[data-default="1"]', gallery).forEach(t => t.remove());
      for(const f of files){
        if(!f.type.startsWith('image/')) continue;
        const url = await readFileAsDataURL(f);
        const tile = document.createElement('div');
        tile.className = 'tile';
        const img = document.createElement('img');
        img.src = url;
        img.alt = 'Foto de peluche';
        const lbl = document.createElement('div');
        lbl.className = 'label';
        lbl.textContent = 'ğŸ§¸';
        tile.appendChild(img);
        tile.appendChild(lbl);
        gallery.prepend(tile);
      }
      toast('Â¡Fotos agregadas! ğŸ“·');
      fileInput.value = '';
    });

    $('#btnClearGallery').addEventListener('click', () => {
      gallery.innerHTML = `
        <div class="tile" data-default="1"><div class="placeholder">ğŸ§¸</div><div class="label">Oso</div></div>
        <div class="tile" data-default="1"><div class="placeholder">ğŸ°</div><div class="label">Conejo</div></div>
        <div class="tile" data-default="1"><div class="placeholder">ğŸ¦–</div><div class="label">Dino</div></div>
        <div class="tile" data-default="1"><div class="placeholder">ğŸ»</div><div class="label">Oso</div></div>
        <div class="tile" data-default="1"><div class="placeholder">ğŸ™</div><div class="label">Pulpo</div></div>
        <div class="tile" data-default="1"><div class="placeholder">ğŸ¦Š</div><div class="label">Zorro</div></div>
      `;
      toast('GalerÃ­a limpia ğŸ§¹');
    });

    function readFileAsDataURL(file){
      return new Promise((resolve, reject) => {
        const r = new FileReader();
        r.onload = () => resolve(String(r.result));
        r.onerror = reject;
        r.readAsDataURL(file);
      });
    }

    // ---------------------- Reading (real words) ----------------------
    const realWords = [
      'MAMA','PAPA','CASA','PATO','GATO','SOPA','LUNA','SOL','MESA','SILLA',
      'MANO','PIE','BOLA','VACA','DADO','PELO','NENE','BEBE','TACO','RISA'
    ];
    const syllEl = $('#syllable');
    const wordEl = $('#word');

    function splitSyllablesSimple(w){
      // Simple visual split in chunks of 2 letters (works OK for kinder words)
      return (w.match(/.{1,2}/g) || [w]).join('-');
    }

    function newRealWord(){
      const w = realWords[Math.floor(Math.random()*realWords.length)];
      wordEl.textContent = w;
      syllEl.textContent = splitSyllablesSimple(w);
      toast('Palabra real ğŸ“˜');
    }

    $('#btnNewWord').addEventListener('click', newRealWord);
    $('#btnSpeakWord').addEventListener('click', () => speak(wordEl.textContent));
    $('#btnClapWord').addEventListener('click', () => { confettiEmojis(); toast('Â¡Muy bien! â­'); });

    // ---------------------- Tracing canvas ----------------------
    const canvas = $('#traceCanvas');
    const ctx = canvas.getContext('2d');

    function fitCanvas(){
      const rect = canvas.getBoundingClientRect();
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      canvas.width  = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      drawLetter();

      // tambiÃ©n ajusta el canvas de colorear
      fitColorCanvas();
    }

    function drawLetter(){
      const rect = canvas.getBoundingClientRect();
      ctx.clearRect(0,0,rect.width,rect.height);

      // guide lines
      ctx.save();
      ctx.globalAlpha = 0.25;
      ctx.lineWidth = 2;
      ctx.setLineDash([10,10]);
      ctx.beginPath();
      ctx.moveTo(16, rect.height*0.25);
      ctx.lineTo(rect.width-16, rect.height*0.25);
      ctx.moveTo(16, rect.height*0.75);
      ctx.lineTo(rect.width-16, rect.height*0.75);
      ctx.strokeStyle = '#475569';
      ctx.stroke();
      ctx.restore();

      const baseLetter = $('#letterSelect').value;
      const isUpper = $('#caseSelect').value === 'upper';
      const letter = isUpper ? baseLetter.toUpperCase() : baseLetter.toLowerCase();

      ctx.save();
      ctx.font = `900 ${Math.floor(rect.height*0.62)}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.globalAlpha = 0.20;
      ctx.fillStyle = '#0f172a';
      ctx.fillText(letter, rect.width/2, rect.height/2 + 6);
      ctx.restore();

      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.strokeStyle = '#0f172a';
      ctx.lineWidth = 8;
    }

    let drawing = false;
    let last = null;

    function pointFromEvent(e){
      const rect = canvas.getBoundingClientRect();
      const p = e.touches ? e.touches[0] : e;
      return { x: p.clientX - rect.left, y: p.clientY - rect.top };
    }

    function startDraw(e){ drawing = true; last = pointFromEvent(e); e.preventDefault?.(); }
    function moveDraw(e){
      if(!drawing) return;
      const p = pointFromEvent(e);
      ctx.beginPath();
      ctx.moveTo(last.x, last.y);
      ctx.lineTo(p.x, p.y);
      ctx.stroke();
      last = p;
      e.preventDefault?.();
    }
    function endDraw(){ drawing = false; last = null; }

    canvas.addEventListener('mousedown', startDraw);
    window.addEventListener('mousemove', moveDraw);
    window.addEventListener('mouseup', endDraw);
    canvas.addEventListener('touchstart', startDraw, {passive:false});
    canvas.addEventListener('touchmove', moveDraw, {passive:false});
    canvas.addEventListener('touchend', endDraw);

    $('#btnTraceReset').addEventListener('click', () => { drawLetter(); toast('Â¡Listo! ğŸ§½'); });

    // ---------------------- Coloring canvas ----------------------
    const colorCanvas = $('#colorCanvas');
    const cctx = colorCanvas.getContext('2d');
    let paintColor = '#3b82f6';
    let paintSize = 10;
    let coloring = false;
    let clast = null;

    function fitColorCanvas(){
      if(!colorCanvas) return;
      const rect = colorCanvas.getBoundingClientRect();
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      colorCanvas.width  = Math.floor(rect.width * dpr);
      colorCanvas.height = Math.floor(rect.height * dpr);
      cctx.setTransform(dpr,0,0,dpr,0,0);
      drawTemplate($('#colorTemplate')?.value || 'dino');
    }

    function drawTemplate(key){
      const rect = colorCanvas.getBoundingClientRect();
      const W = rect.width, H = rect.height;
      const cx = W/2, cy = H/2;

      cctx.clearRect(0,0,W,H);
      cctx.fillStyle = 'rgba(255,255,255,.92)';
      cctx.fillRect(0,0,W,H);

      // optional guide (light grid)
      if($('#showGuide')?.checked){
        cctx.save();
        cctx.globalAlpha = 0.12;
        cctx.strokeStyle = '#475569';
        cctx.lineWidth = 1;
        for(let x=20; x<W; x+=40){
          cctx.beginPath(); cctx.moveTo(x, 0); cctx.lineTo(x, H); cctx.stroke();
        }
        for(let y=20; y<H; y+=40){
          cctx.beginPath(); cctx.moveTo(0, y); cctx.lineTo(W, y); cctx.stroke();
        }
        cctx.restore();
      }

      if(key === 'free') return; // dibujo libre

      cctx.save();
      cctx.strokeStyle = '#0f172a';
      cctx.lineWidth = 5;
      cctx.lineJoin = 'round';
      cctx.lineCap = 'round';

      const rr = (x,y,w,h,r) => {
        // roundRect fallback
        if(typeof cctx.roundRect === 'function'){
          cctx.roundRect(x,y,w,h,r);
          return;
        }
        const rad = Math.min(r, w/2, h/2);
        cctx.moveTo(x+rad, y);
        cctx.arcTo(x+w, y, x+w, y+h, rad);
        cctx.arcTo(x+w, y+h, x, y+h, rad);
        cctx.arcTo(x, y+h, x, y, rad);
        cctx.arcTo(x, y, x+w, y, rad);
      };

      if(key === 'dino'){
        cctx.beginPath();
        cctx.ellipse(cx-30, cy+20, 120, 80, 0, 0, Math.PI*2);
        cctx.stroke();

        cctx.beginPath();
        cctx.ellipse(cx+70, cy-10, 60, 45, 0, 0, Math.PI*2);
        cctx.stroke();

        cctx.beginPath();
        rr(cx-120, cy+70, 50, 70, 18);
        rr(cx-40,  cy+70, 50, 70, 18);
        cctx.stroke();

        cctx.beginPath();
        cctx.moveTo(cx-140, cy+20);
        cctx.quadraticCurveTo(cx-220, cy-10, cx-240, cy-60);
        cctx.stroke();

        const spikes = [[cx-40, cy-70],[cx-10, cy-85],[cx+20, cy-75],[cx+50, cy-55],[cx+80, cy-40]];
        spikes.forEach(([x,y]) => {
          cctx.beginPath();
          cctx.moveTo(x, y);
          cctx.lineTo(x+18, y+34);
          cctx.lineTo(x-18, y+34);
          cctx.closePath();
          cctx.stroke();
        });

        cctx.beginPath();
        cctx.arc(cx+90, cy-18, 8, 0, Math.PI*2);
        cctx.stroke();
      }
      else if(key === 'car'){
        cctx.beginPath();
        rr(cx-170, cy+10, 340, 100, 30);
        cctx.stroke();

        cctx.beginPath();
        rr(cx-110, cy-60, 220, 80, 26);
        cctx.stroke();

        cctx.beginPath();
        rr(cx-80, cy-45, 90, 55, 18);
        rr(cx+10, cy-45, 90, 55, 18);
        cctx.stroke();

        [cx-110, cx+110].forEach(wx => {
          cctx.beginPath();
          cctx.arc(wx, cy+110, 32, 0, Math.PI*2);
          cctx.stroke();
          cctx.beginPath();
          cctx.arc(wx, cy+110, 10, 0, Math.PI*2);
          cctx.stroke();
        });
      }
      else if(key === 'rocket'){
        cctx.beginPath();
        rr(cx-60, cy-90, 120, 220, 60);
        cctx.stroke();

        cctx.beginPath();
        cctx.moveTo(cx-60, cy-90);
        cctx.quadraticCurveTo(cx, cy-170, cx+60, cy-90);
        cctx.stroke();

        cctx.beginPath();
        cctx.moveTo(cx-60, cy+80);
        cctx.lineTo(cx-120, cy+130);
        cctx.lineTo(cx-60, cy+130);
        cctx.closePath();
        cctx.stroke();

        cctx.beginPath();
        cctx.moveTo(cx+60, cy+80);
        cctx.lineTo(cx+120, cy+130);
        cctx.lineTo(cx+60, cy+130);
        cctx.closePath();
        cctx.stroke();

        cctx.beginPath();
        cctx.arc(cx, cy-10, 22, 0, Math.PI*2);
        cctx.stroke();

        cctx.beginPath();
        cctx.moveTo(cx, cy+170);
        cctx.quadraticCurveTo(cx-30, cy+140, cx-10, cy+120);
        cctx.quadraticCurveTo(cx, cy+135, cx+10, cy+120);
        cctx.quadraticCurveTo(cx+30, cy+140, cx, cy+170);
        cctx.closePath();
        cctx.stroke();
      }
      else {
        const r1 = 80, r2 = 34;
        const pts = 10;
        cctx.beginPath();
        for(let i=0;i<pts;i++){
          const a = (Math.PI*2/pts)*i - Math.PI/2;
          const r = (i%2===0) ? r1 : r2;
          const x = cx + Math.cos(a)*r;
          const y = cy + Math.sin(a)*r;
          if(i===0) cctx.moveTo(x,y); else cctx.lineTo(x,y);
        }
        cctx.closePath();
        cctx.stroke();
      }

      cctx.restore();
    }

    function cStart(e){ coloring = true; clast = pointFromEvent(e, colorCanvas); e.preventDefault?.(); }
    function cMove(e){
      if(!coloring) return;
      const p = pointFromEvent(e, colorCanvas);
      cctx.save();
      cctx.strokeStyle = paintColor;
      cctx.lineWidth = paintSize;
      cctx.lineCap = 'round';
      cctx.lineJoin = 'round';
      cctx.beginPath();
      cctx.moveTo(clast.x, clast.y);
      cctx.lineTo(p.x, p.y);
      cctx.stroke();
      cctx.restore();
      clast = p;
      e.preventDefault?.();
    }
    function cEnd(){ coloring = false; clast = null; }

    // Usamos Pointer Events para que funcione igual en mouse y touch
    function cPointerDown(e){
      coloring = true;
      colorCanvas.setPointerCapture?.(e.pointerId);
      clast = pointFromEvent(e, colorCanvas);
      e.preventDefault?.();
    }
    function cPointerMove(e){
      if(!coloring) return;
      const p = pointFromEvent(e, colorCanvas);
      cctx.save();
      cctx.strokeStyle = paintColor;
      cctx.lineWidth = paintSize;
      cctx.lineCap = 'round';
      cctx.lineJoin = 'round';
      cctx.beginPath();
      cctx.moveTo(clast.x, clast.y);
      cctx.lineTo(p.x, p.y);
      cctx.stroke();
      cctx.restore();
      clast = p;
      e.preventDefault?.();
    }
    function cPointerUp(){ coloring = false; clast = null; }

    colorCanvas.addEventListener('pointerdown', cPointerDown);
    colorCanvas.addEventListener('pointermove', cPointerMove);
    colorCanvas.addEventListener('pointerup', cPointerUp);
    colorCanvas.addEventListener('pointercancel', cPointerUp);

    $$('[data-color]').forEach(btn => {
      btn.addEventListener('click', () => {
        paintColor = btn.getAttribute('data-color');
        toast('Color listo ğŸ¨');
        playTone(520, 0.08);
      });
    });

    $('#brushSize').addEventListener('change', () => {
      paintSize = Number($('#brushSize').value);
      toast('Grosor: ' + paintSize);
    });

    $('#colorTemplate').addEventListener('change', () => {
      drawTemplate($('#colorTemplate').value);
      toast($('#colorTemplate').value === 'free' ? 'Dibujo libre ğŸ†“' : 'Nuevo dibujo ğŸ¨');
    });

    $('#showGuide').addEventListener('change', () => {
      drawTemplate($('#colorTemplate').value);
      toast($('#showGuide').checked ? 'GuÃ­a ON âœ…' : 'GuÃ­a OFF âœ…');
    });
      toast('Nuevo dibujo ğŸ¨');
    });

    $('#btnColorReset').addEventListener('click', () => {
      drawTemplate($('#colorTemplate').value);
      toast('Â¡Limpio! ğŸ§½');
    });

    // ---------------------- Writing text + read aloud ----------------------
    $('#btnReadText').addEventListener('click', () => {
      const t = ($('#textToRead').value || '').trim();
      if(!t){ toast('Escribe algo ğŸ™‚'); playTone(220,0.08); return; }
      speak(t);
      toast('Leyendoâ€¦ ğŸ—£ï¸');
    });

    $('#btnClearText').addEventListener('click', () => {
      $('#textToRead').value = '';
      toast('Listo ğŸ§¹');
    });

    $('#btnSticker').addEventListener('click', () => {
      confettiEmojis();
      toast(['â­','ğŸš€','ğŸ¦–','ğŸ‰','âœ¨'][Math.floor(Math.random()*5)] + ' Â¡Sorpresa!');
      playTone(720,0.10);
    });

    // ---------------------- Games router (menu -> panel) ----------------------
    const gamesMenu = $('#gamesMenu');
    const gamePanels = $('#gamePanels');
    const btnBackToMenu = $('#btnBackToMenu');

    function openGame(key){
      gamesMenu.hidden = true;
      gamePanels.hidden = false;
      btnBackToMenu.hidden = false;

      // hide all panels
      ['memorama','parejas','numeros','falta','secuencia'].forEach(k => {
        const el = $('#game-' + k);
        if(el) el.hidden = true;
      });

      const panel = $('#game-' + key);
      if(panel) panel.hidden = false;

      // ensure each game has fresh content if needed
      if(key === 'memorama') newMatchGame();
      if(key === 'parejas') newPairsGame();
      if(key === 'numeros') newNumberGame();
      if(key === 'falta') newMissingGame();
      if(key === 'secuencia') newSeqGame();

      toast('Â¡A jugar! ğŸ®');
    }

    function backToMenu(){
      gamesMenu.hidden = false;
      gamePanels.hidden = true;
      btnBackToMenu.hidden = true;
      toast('Elige un juego ğŸ®');
    }

    btnBackToMenu.addEventListener('click', backToMenu);
    $$('.gameIcon', gamesMenu).forEach(el => {
      el.addEventListener('click', () => openGame(el.getAttribute('data-open')));
    });

    // ---------------------- Game 1: Memorama ----------------------
    const allEmojis = ['ğŸ¶','ğŸ±','ğŸ¦Š','ğŸ»','ğŸ¼','ğŸ¸','ğŸµ','ğŸ¦','ğŸ·','ğŸ°','ğŸ¯','ğŸ¦„'];
    const matchGrid = $('#matchGrid');
    let revealed = [];
    let tries = 0;
    let pairs = 0;

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function newMatchGame(){
      tries = 0; pairs = 0; revealed = [];
      $('#tries').textContent = '0';
      $('#pairs').textContent = '0';

      const picks = shuffle(allEmojis).slice(0,6);
      const deck = shuffle([...picks, ...picks]);

      matchGrid.innerHTML = '';
      deck.forEach((emoji) => {
        const c = document.createElement('div');
        c.className = 'matchCard';
        c.setAttribute('data-emoji', emoji);
        c.textContent = 'â“';
        c.addEventListener('click', () => onFlip(c));
        matchGrid.appendChild(c);
      });
    }

    function onFlip(card){
      if(card.classList.contains('matched')) return;
      if(revealed.includes(card)) return;
      if(revealed.length >= 2) return;

      card.textContent = card.getAttribute('data-emoji');
      revealed.push(card);

      if(revealed.length === 2){
        tries += 1;
        $('#tries').textContent = String(tries);

        const [a,b] = revealed;
        const same = a.getAttribute('data-emoji') === b.getAttribute('data-emoji');
        if(same){
          a.classList.add('matched');
          b.classList.add('matched');
          pairs += 1;
          $('#pairs').textContent = String(pairs);
          revealed = [];
          playTone(520, 0.10); confettiEmojis();
          toast('Â¡Pareja! â­');
          if(pairs === 6){
            toast('Â¡Ganaste! ğŸ‰');
            speak('Â¡Ganaste!');
          }
        }else{
          setTimeout(() => {
            a.textContent = 'â“';
            b.textContent = 'â“';
            revealed = [];
            playTone(220, 0.08);
            toast('Otra vez ğŸ™‚');
          }, 650);
        }
      }
    }

    $('#btnNewMatch').addEventListener('click', newMatchGame);

    // ---------------------- Game 2: Related pairs ----------------------
    const pairSets = [
      ['ğŸ¶','ğŸ¦´'], ['ğŸ±','ğŸŸ'], ['ğŸš—','â›½'], ['ğŸ¦·','ğŸª¥'], ['â˜€ï¸','ğŸ˜'], ['ğŸŒ™','ğŸ˜´'],
      ['ğŸˆ','ğŸ’¥'], ['ğŸ','ğŸ½ï¸'], ['ğŸ“š','âœï¸'], ['âš½','ğŸ¥…'], ['ğŸ§¸','â¤ï¸'], ['ğŸš€','ğŸŒŸ']
    ];
    const pairsGrid = $('#pairsGrid');
    let pairRevealed = [];
    let pairHits = 0;

    function newPairsGame(){
      pairRevealed = [];
      pairHits = 0;
      $('#pairHits').textContent = '0';

      const picks = shuffle(pairSets).slice(0,6);
      const flat = picks.flat();
      const deck = shuffle(flat);

      pairsGrid.innerHTML = '';
      deck.forEach((emoji) => {
        const c = document.createElement('div');
        c.className = 'matchCard';
        c.setAttribute('data-emoji', emoji);
        c.textContent = 'â“';
        c.addEventListener('click', () => onPairsFlip(c, picks));
        pairsGrid.appendChild(c);
      });
    }

    function isRelated(a, b, picks){
      const ea = a.getAttribute('data-emoji');
      const eb = b.getAttribute('data-emoji');
      return picks.some(([x,y]) => (x===ea && y===eb) || (x===eb && y===ea));
    }

    function onPairsFlip(card, picks){
      if(card.classList.contains('matched')) return;
      if(pairRevealed.includes(card)) return;
      if(pairRevealed.length >= 2) return;

      card.textContent = card.getAttribute('data-emoji');
      pairRevealed.push(card);

      if(pairRevealed.length === 2){
        const [a,b] = pairRevealed;
        const ok = isRelated(a,b,picks);
        if(ok){
          a.classList.add('matched');
          b.classList.add('matched');
          pairHits += 1;
          $('#pairHits').textContent = String(pairHits);
          pairRevealed = [];
          confettiEmojis(); playTone(520, 0.10);
          toast('Â¡Van juntos! ğŸ”—');
          if(pairHits === 6){
            toast('Â¡Completaste todo! ğŸ‰');
            speak('Â¡Muy bien!');
          }
        }else{
          setTimeout(() => {
            a.textContent = 'â“';
            b.textContent = 'â“';
            pairRevealed = [];
            playTone(220, 0.08);
            toast('Intenta otra vez ğŸ™‚');
          }, 650);
        }
      }
    }

    $('#btnNewPairs').addEventListener('click', newPairsGame);

    // ---------------------- Game 3: Numbers (number + quantity) ----------------------
    const numTargetEl = $('#numTarget');
    const numDotsEl = $('#numDots');
    const numChoicesEl = $('#numChoices');
    let currentNum = 5;

    function newNumberGame(){
      currentNum = 1 + Math.floor(Math.random()*10);
      numTargetEl.textContent = String(currentNum);
      numDotsEl.innerHTML = '';
      for(let i=0;i<currentNum;i++){
        const d = document.createElement('div');
        d.className = 'dot';
        d.textContent = 'ğŸ§¸';
        numDotsEl.appendChild(d);
      }

      // choices: correct + 3 random
      const choices = new Set([currentNum]);
      while(choices.size < 4) choices.add(1 + Math.floor(Math.random()*10));
      const list = shuffle(Array.from(choices));

      numChoicesEl.innerHTML = '';
      list.forEach(n => {
        const b = document.createElement('div');
        b.className = 'bigCard';
        b.textContent = String(n);
        b.style.cursor = 'pointer';
        b.addEventListener('click', () => {
          if(n === currentNum){
            confettiEmojis(); playTone(620, 0.12);
            toast('Â¡Correcto! ğŸ”¢');
          }else{
            playTone(220, 0.08);
            toast('Casi ğŸ™‚');
          }
        });
        numChoicesEl.appendChild(b);
      });
    }

    $('#btnNewNumber').addEventListener('click', newNumberGame);
    $('#btnSayNumber').addEventListener('click', () => speak(String(currentNum)));

    // ---------------------- Game 4: Missing pattern ----------------------
    const patterns = [
      ['ğŸ','ğŸŒ','ğŸ','ğŸŒ'],
      ['ğŸš—','ğŸš—','ğŸš•','ğŸš—'],
      ['â­','âœ¨','â­','âœ¨'],
      ['ğŸ¶','ğŸ±','ğŸ¶','ğŸ±'],
      ['ğŸŸ¦','ğŸŸ¨','ğŸŸ¦','ğŸŸ¨'],
    ];
    const missingRow = $('#missingRow');
    const missingOptions = $('#missingOptions');
    let missingAnswer = null;
    let streak = 0;

    function newMissingGame(){
      const base = shuffle(patterns)[0].slice();
      const hole = 2; // consistent position for kids
      missingAnswer = base[hole];
      base[hole] = 'â“';

      missingRow.innerHTML = '';
      base.forEach(x => {
        const c = document.createElement('div');
        c.className = 'bigCard';
        c.textContent = x;
        missingRow.appendChild(c);
      });

      const opts = new Set([missingAnswer]);
      while(opts.size < 3){
        const p = shuffle(patterns)[0];
        opts.add(p[Math.floor(Math.random()*p.length)]);
      }
      const list = shuffle(Array.from(opts));

      missingOptions.innerHTML = '';
      list.forEach(x => {
        const o = document.createElement('div');
        o.className = 'bigCard';
        o.textContent = x;
        o.style.cursor = 'pointer';
        o.addEventListener('click', () => {
          if(x === missingAnswer){
            streak += 1; $('#streak').textContent = String(streak);
            confettiEmojis(); playTone(620, 0.12);
            toast('Â¡Muy bien! â“');
            setTimeout(newMissingGame, 450);
          }else{
            streak = 0; $('#streak').textContent = '0';
            playTone(220, 0.08);
            toast('Intenta otra vez ğŸ™‚');
          }
        });
        missingOptions.appendChild(o);
      });
    }

    $('#btnNewMissing').addEventListener('click', newMissingGame);

    // ---------------------- Game 5: Sequences ----------------------
    const seqSets = [
      ['ğŸŒ±','ğŸŒ¿','ğŸŒ³'],
      ['ğŸ£','ğŸ¥','ğŸ”'],
      ['ğŸ§Š','ğŸ’§','ğŸŒŠ'],
      ['ğŸš—','â›½','ğŸ'],
      ['ğŸ›ï¸','ğŸ¦·','ğŸŒ™']
    ];
    const seqSlots = $('#seqSlots');
    const seqChoices = $('#seqChoices');
    let seqAnswer = [];
    let seqState = [];

    function newSeqGame(){
      seqAnswer = shuffle(seqSets)[0].slice();
      seqState = [null,null,null];

      seqSlots.innerHTML = '';
      for(let i=0;i<3;i++){
        const s = document.createElement('div');
        s.className = 'slot';
        s.textContent = 'â“';
        s.setAttribute('data-i', String(i));
        s.addEventListener('click', () => {
          // clear slot if tapped
          if(seqState[i] != null){
            seqState[i] = null;
            s.textContent = 'â“';
          }
        });
        seqSlots.appendChild(s);
      }

      const choices = shuffle(seqAnswer.slice());
      seqChoices.innerHTML = '';
      choices.forEach(ch => {
        const c = document.createElement('div');
        c.className = 'choice';
        c.textContent = ch;
        c.addEventListener('click', () => {
          // place in first empty slot
          const idx = seqState.findIndex(v => v == null);
          if(idx === -1) return;
          seqState[idx] = ch;
          seqSlots.children[idx].textContent = ch;
        });
        seqChoices.appendChild(c);
      });
    }

    $('#btnNewSeq').addEventListener('click', newSeqGame);
    $('#btnCheckSeq').addEventListener('click', () => {
      if(seqState.some(v => v == null)){
        toast('Llena todos los espacios ğŸ™‚');
        playTone(220, 0.08);
        return;
      }
      const ok = seqState.every((v,i) => v === seqAnswer[i]);
      if(ok){
        confettiEmojis();
        toast('Â¡Orden correcto! ğŸ§©');
        speak('Â¡Muy bien!');
        playTone(720, 0.12);
      }else{
        toast('Casiâ€¦ intenta otra vez ğŸ™‚');
        playTone(220, 0.08);
      }
    });

    // ---------------------- Social (fun surprises) ----------------------
    const socials = [
      { name: 'YouTube', ico: 'â–¶ï¸', note: 'Â¡Play y estrellas!' },
      { name: 'TikTok',  ico: 'ğŸµ', note: 'Â¡Bailito!' },
      { name: 'WhatsApp', ico: 'ğŸ’¬', note: 'Â¡Mensaje secreto!' },
      { name: 'Instagram', ico: 'ğŸ“¸', note: 'Â¡Foto mÃ¡gica!' },
      { name: 'Facebook', ico: 'ğŸ‘', note: 'Â¡Like gigante!' },
      { name: 'X', ico: 'âŒ', note: 'Â¡X sorpresa!' },
    ];

    function socialSurprise(name){
      const roll = Math.floor(Math.random()*4);
      if(roll === 0){ confettiEmojis(); }
      if(roll === 1){ playTone(600, 0.12); playTone(900, 0.12); }
      if(roll === 2){ playTone(220, 0.08); setTimeout(()=> playTone(520, 0.10), 90); }
      if(roll === 3){ confettiEmojis(); playTone(720, 0.10); }
      toast('Â¡' + name + '! ğŸŒˆ');
      speak(name);
    }

    const socialGrid = $('#socialGrid');
    function renderSocials(){
      socialGrid.innerHTML = '';
      socials.forEach(s => {
        const b = document.createElement('div');
        b.className = 'socialBtn';
        b.innerHTML = `
          <div class="ico">${s.ico}</div>
          <div class="txt"><b>${s.name}</b><span>${s.note}</span></div>
        `;
        b.addEventListener('click', () => socialSurprise(s.name));
        socialGrid.appendChild(b);
      });
    }

    // ---------------------- Daily challenge ----------------------
    const challenges = [
      'Encuentra 3 cosas rojas en casa. â¤ï¸',
      'Salta 10 veces como un conejito. ğŸ°',
      'Dime 5 animales que vuelen. ğŸ¦',
      'Busca una cosa que empiece con â€œMâ€. ğŸ”¤',
      'Haz una carita feliz en el trazo. ğŸ™‚',
      'Cuenta 12 juguetes y aplaude al final. ğŸ‘',
      'Encuentra una cosa suave y una cosa dura. ğŸ§¸ğŸª¨',
      'Imita un leÃ³n por 5 segundos. ğŸ¦',
      'Ordena 3 peluches por tamaÃ±o. ğŸ“',
      'Di tu nombre y luego deletrea la primera letra. â­'
    ];

    function newChallenge(){
      const msg = challenges[Math.floor(Math.random()*challenges.length)];
      $('#dailyChallenge').textContent = msg;
      toast('Nuevo reto â­');
    }

    $('#btnNewChallenge').addEventListener('click', newChallenge);
    $('#btnReadChallenge').addEventListener('click', () => speak($('#dailyChallenge').textContent));

    // ---------------------- Init ----------------------
    window.addEventListener('load', () => {
      // letras Aâ€“Z
      const letterSelect = $('#letterSelect');
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').forEach(l => {
        const o = document.createElement('option');
        o.value = l;
        o.textContent = l;
        letterSelect.appendChild(o);
      });
      letterSelect.value = 'A';

      $('#caseSelect').addEventListener('change', drawLetter);
      letterSelect.addEventListener('change', drawLetter);

      fitCanvas();
      renderSocials();
      newRealWord();

      // start in games menu
      backToMenu();
    });

    window.addEventListener('resize', () => {
      fitCanvas();
    });
  </script>
</body>
</html>
